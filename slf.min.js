!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).slf=e()}(this,(function(){"use strict";
/*!
 *  Copyright 2008 Fair Oaks Labs, Inc.
 *  All rights reserved.
 */var t=new function(){var t,e=!1,i=this;i._DeArray=function(t,e,i){return[t.slice(e,e+i)]},i._EnArray=function(t,e,i,n){for(var r=0;r<i;t[e+r]=n[r]?n[r]:0,r++);},i._DeChar=function(t,e){return String.fromCharCode(t[e])},i._EnChar=function(t,e,i){t[e]=i.charCodeAt(0)},i._DeInt=function(i,n){var r,o,s,h=e?t.len-1:0,a=e?-1:1,u=h+a*t.len;for(r=0,o=h,s=1;o!=u;r+=i[n+o]*s,o+=a,s*=256);return t.bSigned&&r&Math.pow(2,8*t.len-1)&&(r-=Math.pow(2,8*t.len)),r},i._EnInt=function(i,n,r){var o,s=e?t.len-1:0,h=e?-1:1,a=s+h*t.len;for(r=r<t.min?t.min:r>t.max?t.max:r,o=s;o!=a;i[n+o]=255&r,o+=h,r>>=8);},i._DeString=function(t,e,i){for(var n=new Array(i),r=0;r<i;n[r]=String.fromCharCode(t[e+r]),r++);return n.join("")},i._EnString=function(t,e,i,n){for(var r,o=0;o<i;t[e+o]=(r=n.charCodeAt(o))?r:0,o++);},i._DeNullString=function(t,e,n,r){var o=i._DeString(t,e,n,r);return o.substring(0,o.length-1)},i._De754=function(i,n){var r,o,s,h,a,u,l,f,c,p;for(l=t.mLen,c=(p=(1<<(f=8*t.len-t.mLen-1))-1)>>1,h=e?0:t.len-1,a=e?1:-1,r=i[n+h],h+=a,o=r&(1<<-(u=-7))-1,r>>=-u,u+=f;u>0;o=256*o+i[n+h],h+=a,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=l;u>0;s=256*s+i[n+h],h+=a,u-=8);switch(o){case 0:o=1-c;break;case p:return s?NaN:1/0*(r?-1:1);default:s+=Math.pow(2,l),o-=c}return(r?-1:1)*s*Math.pow(2,o-l)},i._En754=function(i,n,r){var o,s,h,a,u,l,f,c,p,g;for(f=t.mLen,p=(g=(1<<(c=8*t.len-t.mLen-1))-1)>>1,o=r<0?1:0,r=Math.abs(r),isNaN(r)||r==1/0?(h=isNaN(r)?1:0,s=g):(s=Math.floor(Math.log(r)/Math.LN2),r*(l=Math.pow(2,-s))<1&&(s--,l*=2),(r+=s+p>=1?t.rt/l:t.rt*Math.pow(2,1-p))*l>=2&&(s++,l/=2),s+p>=g?(h=0,s=g):s+p>=1?(h=(r*l-1)*Math.pow(2,f),s+=p):(h=r*Math.pow(2,p-1)*Math.pow(2,f),s=0)),a=e?t.len-1:0,u=e?-1:1;f>=8;i[n+a]=255&h,a+=u,h/=256,f-=8);for(s=s<<f|h,c+=f;c>0;i[n+a]=255&s,a+=u,s/=256,c-=8);i[n+a-u]|=128*o},i._sPattern="(\\d+)?([AxcbBhHsSfdiIlL])(\\(([a-zA-Z0-9]+)\\))?",i._lenLut={A:1,x:1,c:1,b:1,B:1,h:2,H:2,s:1,S:1,f:4,d:8,i:4,I:4,l:4,L:4},i._elLut={A:{en:i._EnArray,de:i._DeArray},s:{en:i._EnString,de:i._DeString},S:{en:i._EnString,de:i._DeNullString},c:{en:i._EnChar,de:i._DeChar},b:{en:i._EnInt,de:i._DeInt,len:1,bSigned:!0,min:-Math.pow(2,7),max:Math.pow(2,7)-1},B:{en:i._EnInt,de:i._DeInt,len:1,bSigned:!1,min:0,max:Math.pow(2,8)-1},h:{en:i._EnInt,de:i._DeInt,len:2,bSigned:!0,min:-Math.pow(2,15),max:Math.pow(2,15)-1},H:{en:i._EnInt,de:i._DeInt,len:2,bSigned:!1,min:0,max:Math.pow(2,16)-1},i:{en:i._EnInt,de:i._DeInt,len:4,bSigned:!0,min:-Math.pow(2,31),max:Math.pow(2,31)-1},I:{en:i._EnInt,de:i._DeInt,len:4,bSigned:!1,min:0,max:Math.pow(2,32)-1},l:{en:i._EnInt,de:i._DeInt,len:4,bSigned:!0,min:-Math.pow(2,31),max:Math.pow(2,31)-1},L:{en:i._EnInt,de:i._DeInt,len:4,bSigned:!1,min:0,max:Math.pow(2,32)-1},f:{en:i._En754,de:i._De754,len:4,mLen:23,rt:Math.pow(2,-24)-Math.pow(2,-77)},d:{en:i._En754,de:i._De754,len:8,mLen:52,rt:0}},i._UnpackSeries=function(e,i,n,r){for(var o=t.de,s=[],h=0;h<e;s.push(o(n,r+h*i)),h++);return s},i._PackSeries=function(e,i,n,r,o,s){for(var h=t.en,a=0;a<e;h(n,r+a*i,o[s+a]),a++);},i._zip=function(t,e){for(var i={},n=0;n<t.length;n++)i[t[n]]=e[n];return i},i.unpack=function(i,n,r){e="<"!=i.charAt(0),r=r||0;for(var o,s,h,a=new RegExp(this._sPattern,"g"),u=[],l=[];o=a.exec(i);){if(s=null==o[1]||""==o[1]?1:parseInt(o[1]),"S"===o[2]){for(s=0;0!==n[r+s];)s++;s++}if(r+s*(h=this._lenLut[o[2]])>n.length)return;switch(o[2]){case"A":case"s":case"S":l.push(this._elLut[o[2]].de(n,r,s));break;case"c":case"b":case"B":case"h":case"H":case"i":case"I":case"l":case"L":case"f":case"d":t=this._elLut[o[2]],l.push(this._UnpackSeries(s,h,n,r))}u.push(o[4]),r+=s*h}return l=Array.prototype.concat.apply([],l),-1!==u.indexOf(void 0)?l:this._zip(u,l)},i.packTo=function(i,n,r,o){e="<"!=i.charAt(0);for(var s,h,a,u,l=new RegExp(this._sPattern,"g"),f=0;s=l.exec(i);){if(h=null==s[1]||""==s[1]?1:parseInt(s[1]),"S"===s[2]&&(h=o[f].length+1),r+h*(a=this._lenLut[s[2]])>n.length)return!1;switch(s[2]){case"A":case"s":case"S":if(f+1>o.length)return!1;this._elLut[s[2]].en(n,r,h,o[f]),f+=1;break;case"c":case"b":case"B":case"h":case"H":case"i":case"I":case"l":case"L":case"f":case"d":if(t=this._elLut[s[2]],f+h>o.length)return!1;this._PackSeries(h,a,n,r,o,f),f+=h;break;case"x":for(u=0;u<h;u++)n[r+u]=0}r+=h*a}return n},i.pack=function(t,e){return this.packTo(t,new Buffer(this.calcLength(t,e)),0,e)},i.calcLength=function(t,e){for(var i,n=new RegExp(this._sPattern,"g"),r=0,o=0;i=n.exec(t);){var s=(null==i[1]||""==i[1]?1:parseInt(i[1]))*this._lenLut[i[2]];"S"===i[2]&&(s=e[o].length+1),r+=s,"x"!==i[2]&&o++}return r}};[Array,Int8Array,Int16Array,Int32Array,Uint8Array,Uint16Array,Uint32Array,Float32Array].forEach((function(t){t.prototype.range||(t.prototype.range=function(){for(var t=0;t<this.length;t++)this[t]=t;return this}),t.prototype.random||(t.prototype.random=function(){for(var t=0;t<this.length;t++)this[t]=parseInt(Math.random()*(this.length-1));return this}),t.prototype.clamp||(t.prototype.clamp=function(t,e){for(var i=0;i<this.length;i++)this[i]=i.clamp(t,e);return this}),t.prototype.min||(t.prototype.min=function(){for(var t=1/0,e=this.length,i=0;i<e;i++)this[i]<t&&(t=this[i]);return t}),t.prototype.max||(t.prototype.max=function(){for(var t=-1/0,e=this.length,i=0;i<e;i++)this[i]>t&&(t=this[i]);return t}),t.prototype.add||(t.prototype.add=function(t){for(var e=0,i=this.length;e<i;e++)this[e]+=t;return this}),t.prototype.subtract||(t.prototype.subtract=function(t){for(var e=0,i=this.length;e<i;e++)this[e]-=t;return this}),t.prototype.multiply||(t.prototype.multiply=function(t){for(var e=0,i=this.length;e<i;e++)this[e]*=t;return this}),t.prototype.divide||(t.prototype.divide=function(t){for(var e=0,i=this.length;e<i;e++)this[e]/=t;return this}),t.prototype.compare||(t.prototype.compare=function(t){for(var e=0,i=this.length;e<i;e++)if(t[e]-this[e]>1e-7)return!1;return!0})}));var i=function(t,e){if(t=void 0!==t?t:0,!Number.isInteger(t))throw Error("Error in range: Value must be an integer");var i;"Uint8"==e&&(i=new Uint8Array(t)),"Uint16"==e&&(i=new Uint16Array(t)),"Uint32"==e&&(i=new Uint32Array(t)),"Int8"==e&&(i=new Int8Array(t)),"Int16"==e&&(i=new Int16Array(t)),"Int32"==e&&(i=new Int32Array(t)),"Float32"==e&&(i=new Float32Array(t)),void 0!==e&&i||(i=new Array(t));for(var n=0;n<t;n++)i[n]=n;return i};function n(t,e,i){void 0===i&&(i={});var n={type:"Feature"};return(0===i.id||i.id)&&(n.id=i.id),i.bbox&&(n.bbox=i.bbox),n.properties=e||{},n.geometry=t,n}function r(t,e,i){void 0===i&&(i={});for(var r=0,o=t;r<o.length;r++){var s=o[r];if(s.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var h=0;h<s[s.length-1].length;h++)if(s[s.length-1][h]!==s[0][h])throw new Error("First and last Position are not equivalent.")}return n({type:"Polygon",coordinates:t},e,i)}function o(t,e,i){var n=i;return function(t,e){var i,n,r,o,s,h,a,u,l,f,c=0,p="FeatureCollection"===t.type,g="Feature"===t.type,y=p?t.features.length:1;for(i=0;i<y;i++){for(h=p?t.features[i].geometry:g?t.geometry:t,u=p?t.features[i].properties:g?t.properties:{},l=p?t.features[i].bbox:g?t.bbox:void 0,f=p?t.features[i].id:g?t.id:void 0,s=(a=!!h&&"GeometryCollection"===h.type)?h.geometries.length:1,r=0;r<s;r++)if(null!==(o=a?h.geometries[r]:h))switch(o.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(o,c,u,l,f))return!1;break;case"GeometryCollection":for(n=0;n<o.geometries.length;n++)if(!1===e(o.geometries[n],c,u,l,f))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,c,u,l,f))return!1;c++}}(t,(function(t,r,o,s,h){n=0===r&&void 0===i?t:e(n,t,r,o,s,h)})),n}function s(t){return o(t,(function(t,e){return t+function(t){var e,i=0;switch(t.type){case"Polygon":return h(t.coordinates);case"MultiPolygon":for(e=0;e<t.coordinates.length;e++)i+=h(t.coordinates[e]);return i;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}(e)}),0)}function h(t){var e=0;if(t&&t.length>0){e+=Math.abs(a(t[0]));for(var i=1;i<t.length;i++)e-=Math.abs(a(t[i]))}return e}function a(t){var e,i,n,r,o,s,h=0,a=t.length;if(a>2){for(s=0;s<a;s++)s===a-2?(n=a-2,r=a-1,o=0):s===a-1?(n=a-1,r=0,o=1):(n=s,r=s+1,o=s+2),e=t[n],i=t[r],h+=(u(t[o][0])-u(e[0]))*Math.sin(u(i[1]));h=6378137*h*6378137/2}return h}function u(t){return t*Math.PI/180}
/**
 * splaytree v3.1.1
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function l(t,e){var i,n,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:h(0),throw:h(1),return:h(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function h(o){return function(h){return function(o){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,n=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],n=0}finally{i=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,h])}}}var f=function(t,e){this.next=null,this.key=t,this.data=e,this.left=null,this.right=null};function c(t,e){return t>e?1:t<e?-1:0}function p(t,e,i){for(var n=new f(null,null),r=n,o=n;;){var s=i(t,e.key);if(s<0){if(null===e.left)break;if(i(t,e.left.key)<0){var h=e.left;if(e.left=h.right,h.right=e,null===(e=h).left)break}o.left=e,o=e,e=e.left}else{if(!(s>0))break;if(null===e.right)break;if(i(t,e.right.key)>0){h=e.right;if(e.right=h.left,h.left=e,null===(e=h).right)break}r.right=e,r=e,e=e.right}}return r.right=e.left,o.left=e.right,e.left=n.right,e.right=n.left,e}function g(t,e,i,n){var r=new f(t,e);if(null===i)return r.left=r.right=null,r;var o=n(t,(i=p(t,i,n)).key);return o<0?(r.left=i.left,r.right=i,i.left=null):o>=0&&(r.right=i.right,r.left=i,i.right=null),r}function y(t,e,i){var n=null,r=null;if(e){var o=i((e=p(t,e,i)).key,t);0===o?(n=e.left,r=e.right):o<0?(r=e.right,e.right=null,n=e):(n=e.left,e.left=null,r=e)}return{left:n,right:r}}var E=function(){function t(t){void 0===t&&(t=c),this._root=null,this._size=0,this._comparator=t}return t.prototype.insert=function(t,e){return this._size++,this._root=g(t,e,this._root,this._comparator)},t.prototype.add=function(t,e){var i=new f(t,e);null===this._root&&(i.left=i.right=null,this._size++,this._root=i);var n=this._comparator,r=p(t,this._root,n),o=n(t,r.key);return 0===o?this._root=r:(o<0?(i.left=r.left,i.right=r,r.left=null):o>0&&(i.right=r.right,i.left=r,r.right=null),this._size++,this._root=i),this._root},t.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},t.prototype._remove=function(t,e,i){var n;return null===e?null:0===i(t,(e=p(t,e,i)).key)?(null===e.left?n=e.right:(n=p(t,e.left,i)).right=e.right,this._size--,n):e},t.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=p(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},t.prototype.findStatic=function(t){for(var e=this._root,i=this._comparator;e;){var n=i(t,e.key);if(0===n)return e;e=n<0?e.left:e.right}return null},t.prototype.find=function(t){return this._root&&(this._root=p(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root},t.prototype.contains=function(t){for(var e=this._root,i=this._comparator;e;){var n=i(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1},t.prototype.forEach=function(t,e){for(var i=this._root,n=[],r=!1;!r;)null!==i?(n.push(i),i=i.left):0!==n.length?(i=n.pop(),t.call(e,i),i=i.right):r=!0;return this},t.prototype.range=function(t,e,i,n){for(var r=[],o=this._comparator,s=this._root;0!==r.length||s;)if(s)r.push(s),s=s.left;else{if(o((s=r.pop()).key,e)>0)break;if(o(s.key,t)>=0&&i.call(n,s))return this;s=s.right}return this},t.prototype.keys=function(){var t=[];return this.forEach((function(e){var i=e.key;return t.push(i)})),t},t.prototype.values=function(){var t=[];return this.forEach((function(e){var i=e.data;return t.push(i)})),t},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.left;)t=t.left;return t},t.prototype.maxNode=function(t){if(void 0===t&&(t=this._root),t)for(;t.right;)t=t.right;return t},t.prototype.at=function(t){for(var e=this._root,i=!1,n=0,r=[];!i;)if(e)r.push(e),e=e.left;else if(r.length>0){if(e=r.pop(),n===t)return e;n++,e=e.right}else i=!0;return null},t.prototype.next=function(t){var e=this._root,i=null;if(t.right){for(i=t.right;i.left;)i=i.left;return i}for(var n=this._comparator;e;){var r=n(t.key,e.key);if(0===r)break;r<0?(i=e,e=e.left):e=e.right}return i},t.prototype.prev=function(t){var e=this._root,i=null;if(null!==t.left){for(i=t.left;i.right;)i=i.right;return i}for(var n=this._comparator;e;){var r=n(t.key,e.key);if(0===r)break;r<0?e=e.left:(i=e,e=e.right)}return i},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return function(t){var e=t,i=[],n=!1,r=new f(null,null),o=r;for(;!n;)e?(i.push(e),e=e.left):i.length>0?e=(e=o=o.next=i.pop()).right:n=!0;return o.next=null,r.next}(this._root)},t.prototype.load=function(t,e,i){void 0===e&&(e=[]),void 0===i&&(i=!1);var n=t.length,r=this._comparator;if(i&&function t(e,i,n,r,o){if(n>=r)return;var s=e[n+r>>1],h=n-1,a=r+1;for(;;){do{h++}while(o(e[h],s)<0);do{a--}while(o(e[a],s)>0);if(h>=a)break;var u=e[h];e[h]=e[a],e[a]=u,u=i[h],i[h]=i[a],i[a]=u}t(e,i,n,a,o),t(e,i,a+1,r,o)}(t,e,0,n-1,r),null===this._root)this._root=function t(e,i,n,r){var o=r-n;if(o>0){var s=n+Math.floor(o/2),h=e[s],a=i[s],u=new f(h,a);return u.left=t(e,i,n,s),u.right=t(e,i,s+1,r),u}return null}(t,e,0,n),this._size=n;else{var o=function(t,e,i){var n=new f(null,null),r=n,o=t,s=e;for(;null!==o&&null!==s;)i(o.key,s.key)<0?(r.next=o,o=o.next):(r.next=s,s=s.next),r=r.next;null!==o?r.next=o:null!==s&&(r.next=s);return n.next}(this.toList(),function(t,e){for(var i=new f(null,null),n=i,r=0;r<t.length;r++)n=n.next=new f(t[r],e[r]);return n.next=null,i.next}(t,e),r);n=this._size+n,this._root=function t(e,i,n){var r=n-i;if(r>0){var o=i+Math.floor(r/2),s=t(e,i,o),h=e.head;return h.left=s,e.head=e.head.next,h.right=t(e,o+1,n),h}return null}({head:o},0,n)}return this},t.prototype.isEmpty=function(){return null===this._root},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(t){void 0===t&&(t=function(t){return String(t.key)});var e=[];return function t(e,i,n,r,o){if(e){r(i+(n?"└── ":"├── ")+o(e)+"\n");var s=i+(n?"    ":"│   ");e.left&&t(e.left,s,!1,r,o),e.right&&t(e.right,s,!0,r,o)}}(this._root,"",!0,(function(t){return e.push(t)}),t),e.join("")},t.prototype.update=function(t,e,i){var n=this._comparator,r=y(t,this._root,n),o=r.left,s=r.right;n(t,e)<0?s=g(e,i,s,n):o=g(e,i,o,n),this._root=function(t,e,i){return null===e?t:(null===t||((e=p(t.key,e,i)).left=t),e)}(o,s,n)},t.prototype.split=function(t){return y(t,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var t;return l(this,(function(e){switch(e.label){case 0:t=this.minNode(),e.label=1;case 1:return t?[4,t]:[3,3];case 2:return e.sent(),t=this.next(t),[3,1];case 3:return[2]}}))},t}();function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function d(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function m(t,e,i){return e&&d(t.prototype,e),i&&d(t,i),t}var N=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},x=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var i=t.ll.x<e.ll.x?e.ll.x:t.ll.x,n=t.ur.x<e.ur.x?t.ur.x:e.ur.x;return{ll:{x:i,y:t.ll.y<e.ll.y?e.ll.y:t.ll.y},ur:{x:n,y:t.ur.y<e.ur.y?t.ur.y:e.ur.y}}},b=Number.EPSILON;void 0===b&&(b=Math.pow(2,-52));var I=b*b,S=function(t,e){if(-b<t&&t<b&&-b<e&&e<b)return 0;var i=t-e;return i*i<I*t*e?0:t<e?-1:1},_=function(){function t(){v(this,t),this.reset()}return m(t,[{key:"reset",value:function(){this.xRounder=new M,this.yRounder=new M}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),t}(),M=function(){function t(){v(this,t),this.tree=new E,this.round(0)}return m(t,[{key:"round",value:function(t){var e=this.tree.add(t),i=this.tree.prev(e);if(null!==i&&0===S(e.key,i.key))return this.tree.remove(t),i.key;var n=this.tree.next(e);return null!==n&&0===S(e.key,n.key)?(this.tree.remove(t),n.key):t}}]),t}(),A=new _,w=function(t,e){return t.x*e.y-t.y*e.x},P=function(t,e){return t.x*e.x+t.y*e.y},L=function(t,e,i){var n={x:e.x-t.x,y:e.y-t.y},r={x:i.x-t.x,y:i.y-t.y},o=w(n,r);return S(o,0)},R=function(t){return Math.sqrt(P(t,t))},k=function(t,e,i){var n={x:e.x-t.x,y:e.y-t.y},r={x:i.x-t.x,y:i.y-t.y};return P(r,n)/R(r)/R(n)},O=function(t,e,i){return 0===e.y?null:{x:t.x+e.x/e.y*(i-t.y),y:i}},T=function(t,e,i){return 0===e.x?null:{x:i,y:t.y+e.y/e.x*(i-t.x)}},F=function(){function t(e,i){v(this,t),void 0===e.events?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=i}return m(t,null,[{key:"compare",value:function(e,i){var n=t.comparePoints(e.point,i.point);return 0!==n?n:(e.point!==i.point&&e.link(i),e.isLeft!==i.isLeft?e.isLeft?1:-1:G.compare(e.segment,i.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),m(t,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,i=0,n=e.length;i<n;i++){var r=e[i];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var i=this.point.events[e];if(void 0===i.segment.consumedBy)for(var n=e+1;n<t;n++){var r=this.point.events[n];void 0===r.consumedBy&&(i.otherSE.point.events===r.otherSE.point.events&&i.segment.consume(r.segment))}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,i=this.point.events.length;e<i;e++){var n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}},{key:"getLeftmostComparator",value:function(t){var e=this,i=new Map,n=function(n){var r,o,s,h,a,u=n.otherSE;i.set(n,{sine:(r=e.point,o=t.point,s=u.point,h={x:o.x-r.x,y:o.y-r.y},a={x:s.x-r.x,y:s.y-r.y},w(a,h)/R(a)/R(h)),cosine:k(e.point,t.point,u.point)})};return function(t,e){i.has(t)||n(t),i.has(e)||n(e);var r=i.get(t),o=r.sine,s=r.cosine,h=i.get(e),a=h.sine,u=h.cosine;return o>=0&&a>=0?s<u?1:s>u?-1:0:o<0&&a<0?s<u?-1:s>u?1:0:a<o?-1:a>o?1:0}}}]),t}(),B=0,G=function(){function t(e,i,n,r){v(this,t),this.id=++B,this.leftSE=e,e.segment=this,e.otherSE=i,this.rightSE=i,i.segment=this,i.otherSE=e,this.rings=n,this.windings=r}return m(t,null,[{key:"compare",value:function(t,e){var i=t.leftSE.point.x,n=e.leftSE.point.x,r=t.rightSE.point.x,o=e.rightSE.point.x;if(o<i)return 1;if(r<n)return-1;var s=t.leftSE.point.y,h=e.leftSE.point.y,a=t.rightSE.point.y,u=e.rightSE.point.y;if(i<n){if(h<s&&h<a)return 1;if(h>s&&h>a)return-1;var l=t.comparePoint(e.leftSE.point);if(l<0)return 1;if(l>0)return-1;var f=e.comparePoint(t.rightSE.point);return 0!==f?f:-1}if(i>n){if(s<h&&s<u)return-1;if(s>h&&s>u)return 1;var c=e.comparePoint(t.leftSE.point);if(0!==c)return c;var p=t.comparePoint(e.rightSE.point);return p<0?1:p>0?-1:1}if(s<h)return-1;if(s>h)return 1;if(r<o){var g=e.comparePoint(t.rightSE.point);if(0!==g)return g}if(r>o){var y=t.comparePoint(e.rightSE.point);if(y<0)return 1;if(y>0)return-1}if(r!==o){var E=a-s,v=r-i,d=u-h,m=o-n;if(E>v&&d<m)return 1;if(E<v&&d>m)return-1}return r>o?1:r<o||a<u?-1:a>u?1:t.id<e.id?-1:t.id>e.id?1:0}}]),m(t,[{key:"replaceRightSE",value:function(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:t>e?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,i=this.rightSE.point,n=this.vector();if(e.x===i.x)return t.x===e.x?0:t.x<e.x?1:-1;var r=(t.y-e.y)/n.y,o=e.x+r*n.x;if(t.x===o)return 0;var s=(t.x-e.x)/n.x,h=e.y+s*n.y;return t.y===h?0:t.y<h?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),i=t.bbox(),n=x(e,i);if(null===n)return null;var r=this.leftSE.point,o=this.rightSE.point,s=t.leftSE.point,h=t.rightSE.point,a=N(e,s)&&0===this.comparePoint(s),u=N(i,r)&&0===t.comparePoint(r),l=N(e,h)&&0===this.comparePoint(h),f=N(i,o)&&0===t.comparePoint(o);if(u&&a)return f&&!l?o:!f&&l?h:null;if(u)return l&&r.x===h.x&&r.y===h.y?null:r;if(a)return f&&o.x===s.x&&o.y===s.y?null:s;if(f&&l)return null;if(f)return o;if(l)return h;var c=function(t,e,i,n){if(0===e.x)return T(i,n,t.x);if(0===n.x)return T(t,e,i.x);if(0===e.y)return O(i,n,t.y);if(0===n.y)return O(t,e,i.y);var r=w(e,n);if(0==r)return null;var o={x:i.x-t.x,y:i.y-t.y},s=w(o,e)/r,h=w(o,n)/r;return{x:(t.x+h*e.x+(i.x+s*n.x))/2,y:(t.y+h*e.y+(i.y+s*n.y))/2}}(r,this.vector(),s,t.vector());return null===c?null:N(n,c)?A.round(c.x,c.y):null}},{key:"split",value:function(e){var i=[],n=void 0!==e.events,r=new F(e,!0),o=new F(e,!1),s=this.rightSE;this.replaceRightSE(o),i.push(o),i.push(r);var h=new t(r,s,this.rings.slice(),this.windings.slice());return F.comparePoints(h.leftSE.point,h.rightSE.point)>0&&h.swapEvents(),F.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(r.checkForConsuming(),o.checkForConsuming()),i}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,i=this.windings.length;e<i;e++)this.windings[e]*=-1}},{key:"consume",value:function(e){for(var i=this,n=e;i.consumedBy;)i=i.consumedBy;for(;n.consumedBy;)n=n.consumedBy;var r=t.compare(i,n);if(0!==r){if(r>0){var o=i;i=n,n=o}if(i.prev===n){var s=i;i=n,n=s}for(var h=0,a=n.rings.length;h<a;h++){var u=n.rings[h],l=n.windings[h],f=i.rings.indexOf(u);-1===f?(i.rings.push(u),i.windings.push(l)):i.windings[f]+=l}n.rings=null,n.windings=null,n.consumedBy=i,n.leftSE.consumedBy=i.leftSE,n.rightSE.consumedBy=i.rightSE}}},{key:"prevInResult",value:function(){return void 0!==this._prevInResult||(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){if(void 0!==this._beforeState)return this._beforeState;if(this.prev){var t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}else this._beforeState={rings:[],windings:[],multiPolys:[]};return this._beforeState}},{key:"afterState",value:function(){if(void 0!==this._afterState)return this._afterState;var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,i=this._afterState.windings,n=this._afterState.multiPolys,r=0,o=this.rings.length;r<o;r++){var s=this.rings[r],h=this.windings[r],a=e.indexOf(s);-1===a?(e.push(s),i.push(h)):i[a]+=h}for(var u=[],l=[],f=0,c=e.length;f<c;f++)if(0!==i[f]){var p=e[f],g=p.poly;if(-1===l.indexOf(g))if(p.isExterior)u.push(g);else{-1===l.indexOf(g)&&l.push(g);var y=u.indexOf(p.poly);-1!==y&&u.splice(y,1)}}for(var E=0,v=u.length;E<v;E++){var d=u[E].multiPoly;-1===n.indexOf(d)&&n.push(d)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0!==this._isInResult)return this._isInResult;var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(j.type){case"union":var i=0===t.length,n=0===e.length;this._isInResult=i!==n;break;case"intersection":var r,o;t.length<e.length?(r=t.length,o=e.length):(r=e.length,o=t.length),this._isInResult=o===j.numMultiPolys&&r<o;break;case"xor":var s=Math.abs(t.length-e.length);this._isInResult=s%2==1;break;case"difference":var h=function(t){return 1===t.length&&t[0].isSubject};this._isInResult=h(t)!==h(e);break;default:throw new Error("Unrecognized operation type found ".concat(j.type))}return this._isInResult}}],[{key:"fromRing",value:function(e,i,n){var r,o,s,h=F.comparePoints(e,i);if(h<0)r=e,o=i,s=1;else{if(!(h>0))throw new Error("Tried to create degenerate segment at [".concat(e.x,", ").concat(e.y,"]"));r=i,o=e,s=-1}return new t(new F(r,!0),new F(o,!1),[n],[s])}}]),t}(),D=function(){function t(e,i,n){if(v(this,t),!Array.isArray(e)||0===e.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=i,this.isExterior=n,this.segments=[],"number"!=typeof e[0][0]||"number"!=typeof e[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var r=A.round(e[0][0],e[0][1]);this.bbox={ll:{x:r.x,y:r.y},ur:{x:r.x,y:r.y}};for(var o=r,s=1,h=e.length;s<h;s++){if("number"!=typeof e[s][0]||"number"!=typeof e[s][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var a=A.round(e[s][0],e[s][1]);a.x===o.x&&a.y===o.y||(this.segments.push(G.fromRing(o,a,this)),a.x<this.bbox.ll.x&&(this.bbox.ll.x=a.x),a.y<this.bbox.ll.y&&(this.bbox.ll.y=a.y),a.x>this.bbox.ur.x&&(this.bbox.ur.x=a.x),a.y>this.bbox.ur.y&&(this.bbox.ur.y=a.y),o=a)}r.x===o.x&&r.y===o.y||this.segments.push(G.fromRing(o,r,this))}return m(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,i=this.segments.length;e<i;e++){var n=this.segments[e];t.push(n.leftSE),t.push(n.rightSE)}return t}}]),t}(),X=function(){function t(e,i){if(v(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new D(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var n=1,r=e.length;n<r;n++){var o=new D(e[n],this,!1);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.interiorRings.push(o)}this.multiPoly=i}return m(t,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,i=this.interiorRings.length;e<i;e++)for(var n=this.interiorRings[e].getSweepEvents(),r=0,o=n.length;r<o;r++)t.push(n[r]);return t}}]),t}(),Y=function(){function t(e,i){if(v(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof e[0][0][0]&&(e=[e])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var n=0,r=e.length;n<r;n++){var o=new X(e[n],this);o.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=o.bbox.ll.x),o.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=o.bbox.ll.y),o.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=o.bbox.ur.x),o.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=o.bbox.ur.y),this.polys.push(o)}this.isSubject=i}return m(t,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,i=this.polys.length;e<i;e++)for(var n=this.polys[e].getSweepEvents(),r=0,o=n.length;r<o;r++)t.push(n[r]);return t}}]),t}(),V=function(){function t(e){v(this,t),this.events=e;for(var i=0,n=e.length;i<n;i++)e[i].segment.ringOut=this;this.poly=null}return m(t,null,[{key:"factory",value:function(e){for(var i=[],n=0,r=e.length;n<r;n++){var o=e[n];if(o.isInResult()&&!o.ringOut){for(var s=null,h=o.leftSE,a=o.rightSE,u=[h],l=h.point,f=[];s=h,h=a,u.push(h),h.point!==l;)for(;;){var c=h.getAvailableLinkedEvents();if(0===c.length){var p=u[0].point,g=u[u.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(p.x,",")+" ".concat(p.y,"]. Last matching segment found ends at")+" [".concat(g.x,", ").concat(g.y,"]."))}if(1===c.length){a=c[0].otherSE;break}for(var y=null,E=0,v=f.length;E<v;E++)if(f[E].point===h.point){y=E;break}if(null===y){f.push({index:u.length,point:h.point});var d=h.getLeftmostComparator(s);a=c.sort(d)[0].otherSE;break}var m=f.splice(y)[0],N=u.splice(m.index);N.unshift(N[0].otherSE),i.push(new t(N.reverse()))}i.push(new t(u))}}return i}}]),m(t,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],i=1,n=this.events.length-1;i<n;i++){var r=this.events[i].point,o=this.events[i+1].point;0!==L(r,t,o)&&(e.push(r),t=r)}if(1===e.length)return null;var s=e[0],h=e[1];0===L(s,t,h)&&e.shift(),e.push(e[0]);for(var a=this.isExteriorRing()?1:-1,u=this.isExteriorRing()?0:e.length-1,l=this.isExteriorRing()?e.length:-1,f=[],c=u;c!=l;c+=a)f.push([e[c].x,e[c].y]);return f}},{key:"isExteriorRing",value:function(){if(void 0===this._isExteriorRing){var t=this.enclosingRing();this._isExteriorRing=!t||!t.isExteriorRing()}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,i=this.events.length;e<i;e++){var n=this.events[e];F.compare(t,n)>0&&(t=n)}for(var r=t.segment.prevInResult(),o=r?r.prevInResult():null;;){if(!r)return null;if(!o)return r.ringOut;if(o.ringOut!==r.ringOut)return o.ringOut.enclosingRing()!==r.ringOut?r.ringOut:r.ringOut.enclosingRing();r=o.prevInResult(),o=r?r.prevInResult():null}}}]),t}(),H=function(){function t(e){v(this,t),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return m(t,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,i=this.interiorRings.length;e<i;e++){var n=this.interiorRings[e].getGeom();null!==n&&t.push(n)}return t}}]),t}(),C=function(){function t(e){v(this,t),this.rings=e,this.polys=this._composePolys(e)}return m(t,[{key:"getGeom",value:function(){for(var t=[],e=0,i=this.polys.length;e<i;e++){var n=this.polys[e].getGeom();null!==n&&t.push(n)}return t}},{key:"_composePolys",value:function(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];if(!r.poly)if(r.isExteriorRing())e.push(new H(r));else{var o=r.enclosingRing();o.poly||e.push(new H(o)),o.poly.addInterior(r)}}return e}}]),t}(),K=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G.compare;v(this,t),this.queue=e,this.tree=new E(i),this.segments=[]}return m(t,[{key:"process",value:function(t){var e=t.segment,i=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),i;var n=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!n)throw new Error("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var r=n,o=n,s=void 0,h=void 0;void 0===s;)null===(r=this.tree.prev(r))?s=null:void 0===r.key.consumedBy&&(s=r.key);for(;void 0===h;)null===(o=this.tree.next(o))?h=null:void 0===o.key.consumedBy&&(h=o.key);if(t.isLeft){var a=null;if(s){var u=s.getIntersection(e);if(null!==u&&(e.isAnEndpoint(u)||(a=u),!s.isAnEndpoint(u)))for(var l=this._splitSafely(s,u),f=0,c=l.length;f<c;f++)i.push(l[f])}var p=null;if(h){var g=h.getIntersection(e);if(null!==g&&(e.isAnEndpoint(g)||(p=g),!h.isAnEndpoint(g)))for(var y=this._splitSafely(h,g),E=0,v=y.length;E<v;E++)i.push(y[E])}if(null!==a||null!==p){var d=null;if(null===a)d=p;else if(null===p)d=a;else{d=F.comparePoints(a,p)<=0?a:p}this.queue.remove(e.rightSE),i.push(e.rightSE);for(var m=e.split(d),N=0,x=m.length;N<x;N++)i.push(m[N])}i.length>0?(this.tree.remove(e),i.push(t)):(this.segments.push(e),e.prev=s)}else{if(s&&h){var b=s.getIntersection(h);if(null!==b){if(!s.isAnEndpoint(b))for(var I=this._splitSafely(s,b),S=0,_=I.length;S<_;S++)i.push(I[S]);if(!h.isAnEndpoint(b))for(var M=this._splitSafely(h,b),A=0,w=M.length;A<w;A++)i.push(M[A])}}this.tree.remove(e)}return i}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var i=t.rightSE;this.queue.remove(i);var n=t.split(e);return n.push(i),void 0===t.consumedBy&&this.tree.insert(t),n}}]),t}(),U="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,z="undefined"!=typeof process&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,j=new(function(){function t(){v(this,t)}return m(t,[{key:"run",value:function(t,e,i){j.type=t,A.reset();for(var n=[new Y(e,!0)],r=0,o=i.length;r<o;r++)n.push(new Y(i[r],!1));if(j.numMultiPolys=n.length,"difference"===j.type)for(var s=n[0],h=1;h<n.length;)null!==x(n[h].bbox,s.bbox)?h++:n.splice(h,1);if("intersection"===j.type)for(var a=0,u=n.length;a<u;a++)for(var l=n[a],f=a+1,c=n.length;f<c;f++)if(null===x(l.bbox,n[f].bbox))return[];for(var p=new E(F.compare),g=0,y=n.length;g<y;g++)for(var v=n[g].getSweepEvents(),d=0,m=v.length;d<m;d++)if(p.insert(v[d]),p.size>U)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var N=new K(p),b=p.size,I=p.pop();I;){var S=I.key;if(p.size===b){var _=S.segment;throw new Error("Unable to pop() ".concat(S.isLeft?"left":"right"," SweepEvent ")+"[".concat(S.point.x,", ").concat(S.point.y,"] from segment #").concat(_.id," ")+"[".concat(_.leftSE.point.x,", ").concat(_.leftSE.point.y,"] -> ")+"[".concat(_.rightSE.point.x,", ").concat(_.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(p.size>U)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(N.segments.length>z)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var M=N.process(S),w=0,P=M.length;w<P;w++){var L=M[w];void 0===L.consumedBy&&p.insert(L)}b=p.size,I=p.pop()}A.reset();var R=V.factory(N.segments);return new C(R).getGeom()}}]),t}()),W={union:function(t){for(var e=arguments,i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=e[r];return j.run("union",t,n)},intersection:function(t){for(var e=arguments,i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=e[r];return j.run("intersection",t,n)},xor:function(t){for(var e=arguments,i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=e[r];return j.run("xor",t,n)},difference:function(t){for(var e=arguments,i=arguments.length,n=new Array(i>1?i-1:0),r=1;r<i;r++)n[r-1]=e[r];return j.run("difference",t,n)}};function q(t,e){var i,n=Z(e);return("FeatureCollection"===t.type?J(2===(i=t).features.length?W.union(i.features[0].geometry.coordinates,i.features[1].geometry.coordinates):W.union.apply(W,i.features.map((function(t){return t.geometry.coordinates})))):J(W.union(t.geometry.coordinates))).geometry.coordinates.forEach((function(t){n.geometry.coordinates.push(t[0])})),n}function J(t){return void 0===i&&(i={}),n({type:"MultiPolygon",coordinates:t},e,i);var e,i}function Z(t){return r(t&&t.geometry.coordinates||[[[180,90],[-180,90],[-180,-90],[180,-90],[180,90]]])}var Q=function(t){return t*Math.PI/180},$=function(t,e){e||(e={}),this.debug=e.debug||!1,this.keepframes=void 0===e.keepframes||e.keepframes,t?this.initialised(t):this.initialisedBlank()},tt={TRIXY:{configurable:!0},varnames:{configurable:!0},XY:{configurable:!0},IKLEW:{configurable:!0},EDGES:{configurable:!0},BEDGES:{configurable:!0},IEDGES:{configurable:!0},CX:{configurable:!0},CY:{configurable:!0},TRIAREA:{configurable:!0},TRIBBOX:{configurable:!0},BBOX:{configurable:!0},EXTENT:{configurable:!0},POLYGON:{configurable:!0},EXTERIOR:{configurable:!0},INTERIORS:{configurable:!0},POLYGONS:{configurable:!0}};return $.prototype.initialisedBlank=function(){this.file={endian:">",float:["f",4]},this.TITLE="",this.NBV1=0,this.NBV2=0,this.NVAR=this.NBV1+this.NBV2,this.VARINDEX=i(this.NVAR),this.IPARAM=[],this.NELEM3=0,this.NPOIN3=0,this.NDP3=0,this.NPLAN=1,this.NELEM2=0,this.NPOIN2=0,this.NDP2=0,this.NBV1=0,this.VARNAMES=[],this.VARUNITS=[],this.NBV2=0,this.CLDNAMES=[],this.CLDUNITS=[],this.IKLE3=[],this.IKLE2=[],this.IPOB2=[],this.IPOB3=[],this.MESHX=[],this.MESHY=[],this.tags={cores:[],times:[]},this.NFRAME=0},$.prototype.initialised=function(t){var e=this.debug;e&&console.time("Initialised selafin object"),e&&console.time("Buffer to Uint8Array"),this.uint8array=new Uint8Array(t),e&&console.timeEnd("Buffer to Uint8Array"),this.file={},this.file.endian=this.getEndianFromChar(80);var i=this.getHeaderMetaDataSLF();e&&console.time("Get connectivity matrix");var n=this.getHeaderIntegersSLF(i);e&&console.timeEnd("Get connectivity matrix"),e&&console.time("Change connectivity matrix: id to index"),this.IKLE3.add(-1),e&&console.timeEnd("Change connectivity matrix: id to index"),e&&console.time("Reorder connectivity matrix"),this.IKLE3F=this.IKLE3,this.IKLE3=this.reshapeIKLE(),e&&console.timeEnd("Reorder connectivity matrix"),this.file.float=this.getFloatTypeFromFloat(n),e&&console.time("Get mesh XY");var r=this.getHeaderFloatsSLF(n);e&&console.timeEnd("Get mesh XY"),e&&console.time("Get frame tags"),this.tags=this.getTimeHistorySLF(r),e&&console.timeEnd("Get frame tags"),this.keepframes&&this.getFrames(),this.initializeProperties(),e&&(console.timeEnd("Initialised selafin object"),console.log("NELEM:%d,NPOIN:%d,NFRAME:%d",this.NELEM3,this.NPOIN3,this.NFRAME))},$.prototype.initializeProperties=function(){this._TRIXY=null,this._TRIAREA=null,this._CX=null,this._CY=null,this._EDGES=null,this._BEDGES=null,this._IEDGES=null},$.prototype.getEndianFromChar=function(e){var i,n,r,o,s=this.uint8array,h=">";if(r=(i=t.unpack(h+"i"+e+"si",s,0))[0],i[1],(o=i[2])!=e&&(h="<",r=(n=t.unpack(h+"i"+e+"si",s,0))[0],n[1],o=n[2]),r!=o)throw Error("... Cannot read "+e+" characters from your binary file +> Maybe it is the wrong file format ?");return h},$.prototype.getHeaderMetaDataSLF=function(){var e,n,r,o,s=this.uint8array,h=this.file.endian,a=0;(e=t.unpack(h+"i80si",s,a))[0],this.TITLE=e[1],e[2],a+=88,(n=t.unpack(h+"iiii",s,a))[0],this.NBV1=n[1],this.NBV2=n[2],n[3],a+=16,this.NVAR=this.NBV1+this.NBV2,this.VARINDEX=i(this.NVAR,"Uint8Array"),this.VARNAMES=[],this.VARUNITS=[],this.CLDNAMES=[],this.CLDUNITS=[];for(var u=0;u<this.NBV1;u++){var l,f;(r=t.unpack(h+"i16s16si",s,a))[0],l=r[1],f=r[2],r[3],a+=40,this.VARNAMES.push(l),this.VARUNITS.push(f)}for(var c=0;c<this.NBV2;c++){var p,g;(o=t.unpack(h+"i16s16si",s,a))[0],p=o[1],g=o[2],o[3],a+=40,this.CLDNAMES.push(p),this.CLDUNITS.push(g)}var y=t.unpack(h+"12i",s,a);return a+=48,this.IPARAM=y.slice(1,11),this.PROJ=this.IPARAM[1],this.DATETIME=new Uint16Array([1972,7,13,17,15,13]),1==this.IPARAM[9]&&(y=t.unpack(h+"8i",a),a+=32,this.DATETIME=y.slice(1,9)),a},$.prototype.getHeaderIntegersSLF=function(e){var i,n=this.uint8array,r=this.file.endian;if((i=t.unpack(r+"6i",n,e))[0],this.NELEM3=i[1],this.NPOIN3=i[2],this.NDP3=i[3],this.NPLAN=i[4],i[5],e+=24,this.NELEM2=this.NELEM3,this.NPOIN2=this.NPOIN3,this.NDP2=this.NDP3,this.NPLAN=Math.max(1,this.NPLAN),this.IPARAM[6]>1&&(this.NPLAN=this.IPARAM[6],this.NELEM2=this.NELEM3/(this.NPLAN-1),this.NPOIN2=this.NPOIN3/this.NPLAN,this.NDP2=this.NDP3/2),e+=4,this.IKLE3=new Uint32Array(t.unpack(r+this.NELEM3*this.NDP3+"i",n,e)),e+=4*this.NELEM3*this.NDP3,e+=4,this.NPLAN>1)throw Error("Check Javascript for 3D");return e+=4,this.IPOB3=new Uint32Array(t.unpack(r+this.NPOIN3+"i",n,e)),e+=4*this.NPOIN3,e+=4},$.prototype.getFloatTypeFromFloat=function(e){var i=this.uint8array,n=this.file.endian,r=this.NPOIN3,o=4,s="f",h=t.unpack(n+"i",i,e);e+=4,h[0]!=o*r&&(o=8,s="d"),e+=o*r;var a=t.unpack(n+"i",i,e);if(h[0]!=a[0])throw Error("... Cannot read "+r+" floats from your binary file +> Maybe it is the wrong file format ?");return[s,o]},$.prototype.getHeaderFloatsSLF=function(e){var i=this.uint8array,n=this.file.endian,r=this.file.float,o=r[0],s=r[1];return e+=4,this.MESHX=new Float32Array(t.unpack(n+this.NPOIN3+o,i,e)),e+=s*this.NPOIN3,e+=4,e+=4,this.MESHY=new Float32Array(t.unpack(n+this.NPOIN3+o,i,e)),e+=s*this.NPOIN3,e+=4},$.prototype.getTimeHistorySLF=function(e){var i=this.uint8array,n=this.file.endian,r=this.file.float,o=r[0],s=r[1];for(varATs=[],ATt=[];;)try{ATt.push(e),e+=4,ATs.push(t.unpack(n+o,i,e)[0]),e+=s,e+=4,e+=this.NVAR*(4+s*this.NPOIN3+4)}catch(t){ATt.pop(ATt.length-1);break}return this.NFRAME=ATs.length,{cores:ATt,times:new Float32Array(ATs)}},$.prototype.writeHeaderSLF=function(){var e=this.file.endian,i=this.file.float,n=i[0],r=i[1],o=new Buffer(0);o=Buffer.concat([o,t.pack(e+"i80si",[80,this.TITLE,80])]),o=Buffer.concat([o,t.pack(e+"iiii",[8,this.NBV1,this.NBV2,8])]);for(var s=0;s<this.NBV1;s++)o=Buffer.concat([o,t.pack(e+"i16s16si",[32,this.VARNAMES[s],this.VARUNITS[s],32])]);for(var h=0;h<this.NBV2;h++)o=Buffer.concat([o,t.pack(e+"i16s16si",[32,this.CLDNAMES[h],this.CLDUNITS[h],32])]);o=Buffer.concat([o,t.pack(e+"i",[40])]);for(var a=0;a<this.IPARAM.length;a++)o=Buffer.concat([o,t.pack(e+"i",[this.IPARAM[a]])]);if(o=Buffer.concat([o,t.pack(e+"i",[40])]),1==this.IPARAM[9]){o=Buffer.concat([o,t.pack(e+"i",[24])]);for(var u=0;u<6;u++)o=Buffer.concat([o,t.pack(e+"i",[this.DATETIME[u]])]);o=Buffer.concat([o,t.pack(e+"i",[24])])}o=Buffer.concat([o,t.pack(e+"6i",[16,this.NELEM3,this.NPOIN3,this.NDP3,1,16])]),o=Buffer.concat([o,t.pack(e+"i",[4*this.NELEM3*this.NDP3])]),o=Buffer.concat([o,t.pack(e+this.NELEM3*this.NDP3+"i",this.IKLE3F.add(1))]),o=Buffer.concat([o,t.pack(e+"i",[4*this.NELEM3*this.NDP3])]),o=Buffer.concat([o,t.pack(e+"i",[4*this.NPOIN3])]),o=Buffer.concat([o,t.pack(e+(this.NPOIN3+"i"),this.IPOB3)]),o=Buffer.concat([o,t.pack(e+"i",[4*this.NPOIN3])]),o=Buffer.concat([o,t.pack(e+"i",[r*this.NPOIN3])]);for(var l=0;l<this.NPLAN;l++)o=Buffer.concat([o,t.pack(e+(this.NPOIN2+n),this.MESHX)]);o=Buffer.concat([o,t.pack(e+"i",[r*this.NPOIN3])]),o=Buffer.concat([o,t.pack(e+"i",[r*this.NPOIN3])]);for(var f=0;f<this.NPLAN;f++)o=Buffer.concat([o,t.pack(e+(this.NPOIN2+n),this.MESHY)]);return o=Buffer.concat([o,t.pack(e+"i",[r*this.NPOIN3])])},$.prototype.writeCoreTimeSLF=function(e,i){var n=this.file.endian,r=this.file.float,o=r[0],s=r[1],h=0!=this.tags.times.length&&this.tags.times[i]?this.tags.times[i]:i;return e=Buffer.concat([e,t.pack(n+"i"+o+"i",[s,h,s])])},$.prototype.writeCoreVarSLF=function(e,i){for(var n=this.file.endian,r=this.file.float,o=r[0],s=r[1],h=0;h<this.NVAR;h++){var a=this.getFrame(i,h);e=Buffer.concat([e,t.pack(n+"i",[s*this.NPOIN3])]),e=Buffer.concat([e,t.pack(n+(this.NPOIN3+o),a)]),e=Buffer.concat([e,t.pack(n+"i",[s*this.NPOIN3])])}return e},$.prototype.getBuffer=function(){for(var t=this.writeHeaderSLF(),e=0;e<this.NFRAME;e++)t=this.writeCoreTimeSLF(t,e),t=this.writeCoreVarSLF(t,e);return t},$.prototype.getFrames=function(){for(var e=this.uint8array,i=this.file.endian,n=this.file.float,r=n[0],o=n[1],s=this.FRAMES=new Float32Array(this.NFRAME*this.NVAR*this.NPOIN3),h=0;h<this.NFRAME;h++){var a=this.tags.cores[h];a+=4+o+4;for(var u=0;u<this.NVAR;u++)a+=4,s.set(t.unpack(i+this.NPOIN3+r,e,a),h*this.NVAR*this.NPOIN3+u*this.NPOIN3),a+=o*this.NPOIN3,a+=4}},$.prototype.getFrame=function(t,e){if(!this.FRAMES)return console.warn("this.FRAMES is null. Add keepframes=true in options"),null;if(e=void 0!==e?e:0,!((t=void 0!==t?t:0)>=0&&t<this.NFRAME))throw Error("Check frame("+this.NFRAME+") id="+t+" ");if(!(e>=0&&e<this.NVAR))throw Error("Check variable id");return this.FRAMES.subarray(t*this.NVAR*this.NPOIN3+e*this.NPOIN3,t*this.NVAR*this.NPOIN3+e*this.NPOIN3+this.NPOIN3)},$.prototype.getMinMax=function(){for(var t=new Float32Array(2*this.NVAR),e=0;e<this.NVAR;e++){for(var i=Number.MIN_VALUE,n=Number.MAX_VALUE,r=0;r<this.NFRAME;r++){var o=this.getFrame(r);n=Math.min(n,o.min()),i=Math.max(i,o.max())}t[2*e]=n,t[2*e+1]=i}return t},$.prototype.getVarMinMax=function(t){return this.minmax.subarray(2*t,2*t+1)},$.prototype.getElements=function(t){if(!t)return this.IKLE3F;if(!Number.isInteger(t)&&!Array.isArray(t))return this.IKLE3F;t=Number.isInteger(t)?[t]:t,this.debug&&console.time("Get elements");for(var e=new Uint32Array(t.length*this.NDP3),i=0,n=0,r=t.length;i<r;i++,n+=3)e[n+0]=this.IKLE3F[t[i]],e[n+1]=this.IKLE3F[t[i]+1],e[n+2]=this.IKLE3F[t[i]+2];return this.debug&&console.timeEnd("Get elements"),e},$.prototype.getElementsW=function(t){if(!t)return this.IKLE3F;if(!Number.isInteger(t)&&!Array.isArray(t))return this.IKLE3F;t=Number.isInteger(t)?[t]:t,this.debug&&console.time("Get elementsW");for(var e=new Uint32Array(t.length*this.NDP3*2),i=0,n=0,r=t.length;i<r;i++,n+=6,3)e[n+0]=this.IKLE3F[t[i]],e[n+1]=this.IKLE3F[t[i]+1],e[n+2]=this.IKLE3F[t[i]+1],e[n+3]=this.IKLE3F[t[i]+2],e[n+4]=this.IKLE3F[t[i]+2],e[n+5]=this.IKLE3F[t[i]];return this.debug&&console.timeEnd("Get elementsW"),e},$.prototype.reshapeIKLE=function(){for(var t=new Uint32Array(this.NELEM3*this.NDP3),e=0,i=0;e<this.NELEM3;e++,i+=3)t[e]=this.IKLE3[i],t[e+this.NELEM3]=this.IKLE3[i+1],t[e+2*this.NELEM3]=this.IKLE3[i+2];return t},tt.TRIXY.get=function(){return this._TRIXY||this.getTriXY(),this._TRIXY},tt.varnames.get=function(){return this.VARNAMES.map((function(t){return t.replace(/\s/g,"").toLowerCase()}))},$.prototype.getVarIndex=function(t){return this.varnames.findIndex((function(e){return e==t}))},tt.XY.get=function(){return this._XY||this.getXY(),this._XY},tt.IKLEW.get=function(){return this._IKLEW||this.getIKLEW(),this._IKLEW},tt.EDGES.get=function(){return this._EDGES||this.getEDGES(),this._EDGES},tt.BEDGES.get=function(){return this._BEDGES||this.getBEDGES(),this._BEDGES},tt.IEDGES.get=function(){return this._IEDGES||this.getIEDGES(),this._IEDGES},tt.CX.get=function(){return this._CX||this.getTriAttributes(),this._CX},tt.CY.get=function(){return this._CY||this.getTriAttributes(),this._CY},tt.TRIAREA.get=function(){return this._TRIAREA||this.getTriAttributes(),this._TRIAREA},tt.TRIBBOX.get=function(){return this._TRIBBOX||this.getTriAttributes(),this._TRIBBOX},tt.BBOX.get=function(){return this.EXTENT},tt.EXTENT.get=function(){return this._EXTENT||this.getExtent(),this._EXTENT},tt.POLYGON.get=function(){return this._POLYGON||this.getPolygon(),this._POLYGON},tt.EXTERIOR.get=function(){return this._EXTERIOR||this.getExtInt(),this._EXTERIOR},tt.INTERIORS.get=function(){return this._INTERIORS||this.getExtInt(),this._INTERIORS},tt.POLYGONS.get=function(){return this._POLYGONS||this.getPolygons(),this._POLYGONS},$.prototype.getExtent=function(){this.debug&&console.time("Get extent"),this._EXTENT=new Float32Array([this.MESHX.min(),this.MESHY.min(),this.MESHX.max(),this.MESHY.max()]),this.debug&&console.timeEnd("Get extent")},$.prototype.getExtInt=function(){this.debug&&console.time("Get exterior/interiors");var t=this.POLYGONS,e=t.map((function(t){return s(t)})),i=this._INTERIORS=e.sortIndices(!0).map((function(e){return t[e]}));this._EXTERIOR=i.shift(),this.debug&&console.timeEnd("Get exterior/interiors")},$.prototype.getCoordinate=function(t){return[this.MESHX[t],this.MESHY[t]]},$.prototype.getPolygon=function(){this.debug&&console.time("Get polygon"),0==this.INTERIORS.length?this._POLYGON=this.EXTERIOR:this._POLYGON=q(function(t,e){void 0===e&&(e={});var i={type:"FeatureCollection"};return e.id&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.features=t,i}(this.INTERIORS),this.EXTERIOR),this.debug&&console.timeEnd("Get polygon")},$.prototype.getPolygons=function(){this.debug&&console.time("Get polygons");for(var t,e,i=this.BEDGES,n=this._POLYGONS=[],o=-1,s=[];i.length>0;)-1==(t=i.findIndex((function(t){return t.start==o||t.end==o})))?(s.length>0&&(n.push(r([s])),s=[]),e=i[0].start,o=i[0].end,s.push(this.getCoordinate(e)),s.push(this.getCoordinate(o)),i.splice(0,1)):(o=i[t].start==o?i[t].end:i[t].start,s.push(this.getCoordinate(o)),i.splice(t,1),0==i.length&&s.length>0&&n.push(r([s])));this.debug&&console.timeEnd("Get polygons")},$.prototype.getIKLEW=function(){this.debug&&console.time("Get connectivity for wireframe");for(var t=this._IKLEW=new Uint32Array(this.NELEM3*this.NDP3*2),e=0,i=0,n=0;e<this.NELEM3;e++,i+=6,n+=3)t[i]=this.IKLE3F[n],t[i+1]=this.IKLE3F[n+1],t[i+2]=this.IKLE3F[n+1],t[i+3]=this.IKLE3F[n+2],t[i+4]=this.IKLE3F[n+2],t[i+5]=this.IKLE3F[n];this.debug&&console.timeEnd("Get connectivity for wireframe")},$.prototype.getTriXY=function(){this.debug&&console.time("Get element xy");for(var t,e,i,n=this._TRIXY=new Float32Array(this.NELEM3*this.NDP3*3),r=0,o=0,s=this.NELEM3;r<s;r++,o+=9)t=this.IKLE3[r],e=this.IKLE3[r+this.NELEM3],i=this.IKLE3[r+2*this.NELEM3],n[o]=this.MESHX[t],n[o+1]=this.MESHY[t],n[o+3]=this.MESHX[e],n[o+4]=this.MESHY[e],n[o+6]=this.MESHX[i],n[o+7]=this.MESHY[i];this.debug&&console.timeEnd("Get element xy")},$.prototype.getXY=function(){this.debug&&console.time("Get points xy");for(var t=this._XY=new Float32Array(3*this.NPOIN3),e=0,i=0,n=this.NPOIN3;e<n;e++,i+=3)t[i]=this.MESHX[e],t[i+1]=this.MESHY[e];this.debug&&console.timeEnd("Get points xy")},$.prototype.getBEDGES=function(){this.debug&&console.time("Get boundary edges");var t=this.EDGES;this._BEDGES=Object.keys(t).filter((function(e){return!t[e].boundary})).map((function(e){return t[e]})),this.debug&&console.timeEnd("Get boundary edges")},$.prototype.getIEDGES=function(){this.debug&&console.time("Get interior edges");var t=this.EDGES;this._IEDGES=Object.keys(t).filter((function(e){return t[e].boundary})).map((function(e){return t[e]})),this.debug&&console.timeEnd("Get interior edges")},$.prototype.getEDGES=function(){this.debug&&console.time("Get edges");var t,i,n,r,o,s,h=this._EDGES={};for(vare=0;e<this.NELEM3;e++)t=this.IKLE3[e],i=this.IKLE3[e+this.NELEM3],n=this.IKLE3[e+2*this.NELEM3],r=Math.min(t,i)+"-"+Math.max(t,i),o=Math.min(i,n)+"-"+Math.max(i,n),s=Math.min(n,t)+"-"+Math.max(n,t),void 0!==h[r]?h[r].boundary=!0:h[r]={boundary:!1,start:Math.min(t,i),end:Math.max(t,i)},void 0!==h[o]?h[o].boundary=!0:h[o]={boundary:!1,start:Math.min(i,n),end:Math.max(i,n)},void 0!==h[s]?h[s].boundary=!0:h[s]={boundary:!1,start:Math.min(n,t),end:Math.max(n,t)};this.debug&&console.timeEnd("Get edges")},$.prototype.getTriAttributes=function(){this.debug&&console.time("Get element attributes");for(var t,e,i,n=this._CX=new Float32Array(this.NELEM3),r=this._CY=new Float32Array(this.NELEM3),o=this._TRIAREA=new Float32Array(this.NELEM3),s=this._TRIBBOX=new Array(this.NELEM3),h=0,a=this.NELEM3;h<a;h++){t=this.IKLE3[h],e=this.IKLE3[h+this.NELEM3],i=this.IKLE3[h+2*this.NELEM3],n[h]=(this.MESHX[t]+this.MESHX[e]+this.MESHX[i])/3,r[h]=(this.MESHY[t]+this.MESHY[e]+this.MESHY[i])/3,s[h]={minX:Math.min(this.MESHX[t],Math.min(this.MESHX[e],this.MESHX[i])),minY:Math.min(this.MESHY[t],Math.min(this.MESHY[e],this.MESHY[i])),maxX:Math.max(this.MESHX[t],Math.max(this.MESHX[e],this.MESHX[i])),maxY:Math.max(this.MESHY[t],Math.max(this.MESHY[e],this.MESHY[i])),index:h};var u=[[this.MESHX[t],this.MESHY[t]],[this.MESHX[e],this.MESHY[e]],[this.MESHX[i],this.MESHY[i]]],l=0;l+=(Q(u[2][0])-Q(u[0][0]))*Math.sin(Q(u[1][1])),l+=(Q(u[1][0])-Q(u[2][0]))*Math.sin(Q(u[0][1])),l+=(Q(u[0][0])-Q(u[1][0]))*Math.sin(Q(u[2][1])),o[h]=6378137*l*6378137*.5}this.debug&&console.timeEnd("Get element attributes")},$.prototype.addTITLE=function(t){this.TITLE=""+t.rpad(" ",80)},$.prototype.addVAR=function(t){t||(t={});var e=t.name||"NewVariable",n=t.unit||"NewUnit";this.NBV1+=1,this.NVAR=this.NBV1+this.NBV2,this.VARINDEX=i(this.NVAR),this.VARNAMES.push(""+e.rpad(" ",16)),this.VARUNITS.push(""+n.rpad(" ",16))},$.prototype.addPOINTS=function(t,e){if(!t)throw new Error("Requires points");this.IPOB3=new Uint32Array(t.length).range(),this.IPOB2=this.IPOB3,this.IPARAM=new Uint8Array(10),this.IPARAM[0]=1,this.NPOIN2=t.length,this.NPOIN3=this.NPOIN2,e?this._addXY(t,e):this._addPoints(t)},$.prototype._addXY=function(t,e){this.MESHX=t,this.MESHY=e},$.prototype._addPoints=function(t){this.MESHX=new Float32Array(this.NPOIN3),this.MESHY=new Float32Array(this.NPOIN3);for(var e=0;e<this.NPOIN3;e++)this.MESHX[e]=t[e].x,this.MESHY[e]=t[e].y},$.prototype.addIKLE=function(t){this.NDP2=3,this.NDP3=3,this.NELEM3=t.length/this.NDP3,this.NELEM2=this.NELEM3,this.IKLE2=t,this.IKLE3=t,this.IKLE3F=this.IKLE3,this.IKLE3=this.reshapeIKLE()},$.prototype.addFrame=function(t){if(t.length!=this.NVAR*this.NPOIN3)throw new Error("Wrong array size");if(this.NFRAME+=1,!this.FRAMES)return this.FRAMES=t;var e=this.FRAMES;this.FRAMES=new Float32Array(this.NFRAME*this.NVAR*this.NPOIN3),this.FRAMES.set(e,0),this.FRAMES.set(t,(this.NFRAME-1)*this.NVAR*this.NPOIN3)},$.prototype.addMesh=function(t,e,i,n){this.empty=!1,this.addTITLE(t),this.addVAR(e),this.addPOINTS(i),this.addIKLE(n)},$.prototype.printAttributes=function(){var t={NFRAME:this.NFRAME,NVAR:this.NVAR,NPOIN3:this.NPOIN3,NELEM3:this.NELEM3,EXTENT:this.EXTENT};console.log(t)},Object.defineProperties($.prototype,tt),$}));
